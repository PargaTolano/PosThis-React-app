{"ast":null,"code":"import _toConsumableArray from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _defineProperty from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import React,{useState,useEffect,useRef}from'react';import{makeStyles}from'@material-ui/core/styles';import{Image as ImageIcon}from'@material-ui/icons';import{TextField,Button,IconButton}from'@material-ui/core';import{FormMediaGrid}from'components/Media';import{handleResponse}from'_helpers';import{authenticationService}from'_services';import{fileToBase64,validateCreateAndUpdatePost}from'_utils';import{createPost}from'_api';import CPostModel from'_model/CPostModel';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{form:{background:'white',width:'100%',maxWidth:'800px',height:'40%',padding:theme.spacing(3),borderRadius:10,alignItems:'center',justifySelf:'center',alignSelf:'center',marginLeft:'auto',marginRight:'auto'},cardBtn:{display:'flex',flexWrap:'wrap',alignItems:'center',justifyContent:'space-between',color:'white',alignSelf:'center'},submit:_defineProperty({order:0,width:'20%'},theme.breakpoints.down('sm'),{order:1,width:'100%',flexGrow:'1',flexShrink:'0',flexBasis:'auto'}),imageIcon:_defineProperty({order:1},theme.breakpoints.down('sm'),{order:0,flexGrow:'1',flexShrink:'0',flexBasis:'auto'}),titleForm:_defineProperty({justifyContent:'space-around',color:theme.palette.primary.dark,alignSelf:'center'},\"color\",'#ea5970'),input:{display:'none'}};});export var CreatePostForm=function CreatePostForm(props){var afterUpdate=props.afterUpdate;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),images=_useState2[0],setImages=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),content=_useState4[0],setContent=_useState4[1];var _useState5=useState({content:false,mediaCount:false,validated:false}),_useState6=_slicedToArray(_useState5,2),validation=_useState6[0],setValidation=_useState6[1];useEffect(function(){setValidation(validateCreateAndUpdatePost({content:content,mediaCount:images.length}));},[images,content]);var inputFileRef=useRef(null);var classes=useStyles();var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();createPost(new CPostModel({userID:authenticationService.currentUserValue.id,content:content,files:images.map(function(x){return x.file;})})).then(handleResponse).then(function(res){setImages([]);setContent('');if(afterUpdate)afterUpdate();}).catch(console.warn);case 2:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();var onChangeImage=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var files,filePairs,i,file,preview;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:files=e.target.files;if(!(images.length+files.length>4)){_context2.next=3;break;}return _context2.abrupt(\"return\");case 3:filePairs=[];i=0;case 5:if(!(i<files.length)){_context2.next=14;break;}file=files[i];_context2.next=9;return fileToBase64(file);case 9:preview=_context2.sent;filePairs.push({file:file,preview:preview});case 11:i++;_context2.next=5;break;case 14:setImages(function(x){return[].concat(_toConsumableArray(x),filePairs);});case 15:case\"end\":return _context2.stop();}}},_callee2);}));return function onChangeImage(_x2){return _ref2.apply(this,arguments);};}();var onChangeContent=function onChangeContent(e){return setContent(e.target.value);};var mediaBtnOnClick=function mediaBtnOnClick(){var _inputFileRef$current;return(_inputFileRef$current=inputFileRef.current)===null||_inputFileRef$current===void 0?void 0:_inputFileRef$current.click();};return/*#__PURE__*/_jsxs(\"form\",{className:classes.form,noValidate:true,onSubmit:onSubmit,children:[/*#__PURE__*/_jsx(\"div\",{component:\"h4\",variant:\"h2\",className:classes.titleForm,children:/*#__PURE__*/_jsx(\"strong\",{children:\"Nuevo PosThis!\"})}),/*#__PURE__*/_jsx(TextField,{variant:\"outlined\",margin:\"normal\",multiline:true,rows:3,rowsMax:3,fullWidth:true,label:\"Escribir...\",name:\"postContent\",autoComplete:\"postContent\",autoFocus:true,value:content,className:classes.postContent,onChange:onChangeContent}),/*#__PURE__*/_jsx(FormMediaGrid,{images:images,setImages:setImages}),/*#__PURE__*/_jsxs(\"div\",{className:classes.cardBtn,children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",color:\"primary\",className:classes.submit,disabled:!validation.validated,children:\"Publicar\"}),/*#__PURE__*/_jsx(\"input\",{accept:\"image/*\",className:classes.input,type:\"file\",multiple:true,ref:inputFileRef,onChange:onChangeImage}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"icon-button-file\",className:classes.imageIcon,children:/*#__PURE__*/_jsx(IconButton,{color:\"primary\",\"aria-label\":\"upload picture\",component:\"span\",onClick:mediaBtnOnClick,children:/*#__PURE__*/_jsx(ImageIcon,{className:classes.imageIcon})})})]})]});};export default CreatePostForm;","map":{"version":3,"sources":["D:/Repositories/Visual C++/PosThis-React-app/src/components/Post/CreatePostForm.js"],"names":["React","useState","useEffect","useRef","makeStyles","Image","ImageIcon","TextField","Button","IconButton","FormMediaGrid","handleResponse","authenticationService","fileToBase64","validateCreateAndUpdatePost","createPost","CPostModel","useStyles","theme","form","background","width","maxWidth","height","padding","spacing","borderRadius","alignItems","justifySelf","alignSelf","marginLeft","marginRight","cardBtn","display","flexWrap","justifyContent","color","submit","order","breakpoints","down","flexGrow","flexShrink","flexBasis","imageIcon","titleForm","palette","primary","dark","input","CreatePostForm","props","afterUpdate","images","setImages","content","setContent","mediaCount","validated","validation","setValidation","length","inputFileRef","classes","onSubmit","e","preventDefault","userID","currentUserValue","id","files","map","x","file","then","res","catch","console","warn","onChangeImage","target","filePairs","i","preview","push","onChangeContent","value","mediaBtnOnClick","current","click","postContent"],"mappings":"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","sourcesContent":["import React,{useState, useEffect, useRef} from 'react';\r\n\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport {\r\n  Image as ImageIcon\r\n} from '@material-ui/icons';\r\n\r\nimport {\r\n  TextField,\r\n  Button,\r\n  IconButton,\r\n} from '@material-ui/core';\r\n\r\nimport { FormMediaGrid }          from 'components/Media';\r\n\r\nimport { handleResponse }         from '_helpers';\r\nimport { authenticationService }  from '_services';\r\nimport { \r\n  fileToBase64,\r\n   validateCreateAndUpdatePost \r\n} from '_utils';\r\nimport { createPost }             from '_api';\r\n\r\nimport CPostModel     from '_model/CPostModel';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  form: {\r\n    background:   'white',\r\n    width:        '100%',\r\n    maxWidth:     '800px',\r\n    height:       '40%',\r\n    padding:      theme.spacing(3),\r\n    borderRadius: 10,  \r\n    alignItems:   'center',\r\n    justifySelf:  'center',\r\n    alignSelf:    'center',\r\n    marginLeft:   'auto',\r\n    marginRight:  'auto',\r\n  },\r\n  cardBtn: {\r\n    display: 'flex',\r\n    flexWrap: 'wrap',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    color: 'white',\r\n    alignSelf:'center',\r\n  },\r\n  submit: {\r\n    order: 0,\r\n    width: '20%',\r\n    [theme.breakpoints.down('sm')]:{\r\n      order: 1,\r\n      width: '100%',\r\n      flexGrow: '1',\r\n      flexShrink: '0',\r\n      flexBasis: 'auto',\r\n    }\r\n  },\r\n  imageIcon: {\r\n    order: 1,\r\n    [theme.breakpoints.down('sm')]:{\r\n      order: 0,\r\n      flexGrow: '1',\r\n      flexShrink: '0',\r\n      flexBasis: 'auto',\r\n    }\r\n  },\r\n  titleForm: {\r\n    justifyContent: 'space-around',\r\n    color: theme.palette.primary.dark ,\r\n    alignSelf:'center',\r\n    color:'#ea5970',\r\n  },\r\n  input: {\r\n    display: 'none',\r\n  },\r\n  \r\n}));\r\n\r\nexport const CreatePostForm = (props) => {\r\n\r\n  const {afterUpdate} = props;\r\n  \r\n  const [images, setImages]   = useState( [] );\r\n  const [content, setContent] = useState( '' );\r\n\r\n  const [validation, setValidation] = useState({\r\n    content:    false,\r\n    mediaCount: false,\r\n    validated:  false\r\n  });\r\n\r\n  useEffect(() => {\r\n    setValidation( validateCreateAndUpdatePost( {content, mediaCount: images.length}) );\r\n  }, [images, content])\r\n\r\n  const inputFileRef = useRef(null);\r\n  \r\n  const classes = useStyles();\r\n  \r\n  const onSubmit = async ( e )=>{\r\n    e.preventDefault();\r\n    createPost( new CPostModel({userID: authenticationService.currentUserValue.id, content,files: images.map(x=>x.file)}))\r\n          .then(handleResponse)\r\n          .then( res =>{\r\n            setImages([]);\r\n            setContent('');\r\n            if( afterUpdate )\r\n              afterUpdate();\r\n          })\r\n          .catch(console.warn);\r\n  };\r\n\r\n  const onChangeImage = async ( e )=>{\r\n    let { files } = e.target;\r\n\r\n    if( images.length + files.length > 4 )\r\n      return;\r\n\r\n    const filePairs = [];\r\n    for ( let i = 0; i < files.length; i++ ){\r\n      let file = files[i];\r\n      let preview = await fileToBase64( file );\r\n      filePairs.push( {\r\n        file,\r\n        preview\r\n      });\r\n    }\r\n\r\n    setImages( x=> [...x,...filePairs] );\r\n  };\r\n\r\n  const onChangeContent = e=>setContent(e.target.value);\r\n\r\n  const mediaBtnOnClick = () =>inputFileRef.current?.click();\r\n\r\n  return (\r\n\r\n    <form className={classes.form} noValidate onSubmit={onSubmit}>\r\n        <div component='h4' variant='h2' className={classes.titleForm}>\r\n          <strong>Nuevo PosThis!</strong>\r\n        </div>\r\n        <TextField\r\n          variant='outlined'\r\n          margin='normal'\r\n          multiline\r\n          rows={3}\r\n          rowsMax={3}\r\n          fullWidth\r\n          label='Escribir...'\r\n          name='postContent'\r\n          autoComplete='postContent'\r\n          autoFocus\r\n          value = {content}\r\n          className={classes.postContent}\r\n          onChange ={onChangeContent}\r\n        />\r\n\r\n      <FormMediaGrid images={images} setImages={setImages}/>\r\n      <div className = {classes.cardBtn}>\r\n      \r\n        <Button\r\n          type='submit'\r\n          fullWidth\r\n          variant='contained'\r\n          color='primary'\r\n          className={classes.submit}\r\n          disabled = {!validation.validated}\r\n        >\r\n          Publicar\r\n        </Button>\r\n          \r\n        <input\r\n          accept='image/*' \r\n          className={classes.input} \r\n          type='file' \r\n          multiple \r\n          ref={inputFileRef} \r\n          onChange={onChangeImage}  \r\n        />\r\n        <label \r\n          htmlFor='icon-button-file' \r\n          className={classes.imageIcon}\r\n        >\r\n          <IconButton \r\n            color='primary' \r\n            aria-label='upload picture' \r\n            component='span' \r\n            onClick={mediaBtnOnClick}\r\n          >\r\n            <ImageIcon className={classes.imageIcon}/>\r\n          </IconButton>\r\n        </label>\r\n        \r\n        </div>\r\n    </form>\r\n       \r\n\r\n  );\r\n}\r\nexport default CreatePostForm;"]},"metadata":{},"sourceType":"module"}