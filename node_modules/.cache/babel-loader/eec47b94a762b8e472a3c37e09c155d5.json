{"ast":null,"code":"import _regeneratorRuntime from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import{Button,CssBaseline,TextField,Grid,Typography,Container,IconButton}from'@material-ui/core';import{Image as ImageIcon,AccountCircle}from'@material-ui/icons';import{makeStyles}from'@material-ui/core/styles';import{updateUser}from'_api';import{fileToBase64,validateUpdateUser}from'_utils';import{handleResponse}from'_helpers';import{authenticationService}from'_services';import{UpdateUserViewModel}from'_model';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{paper:{display:'flex',flexDirection:'column',alignItems:'center'},avatar:{margin:theme.spacing(1),backgroundColor:theme.palette.primary.main},form:{width:'100%',marginTop:theme.spacing(3)},submit:{margin:theme.spacing(3,0,2)},input:{display:'none'},profilePicture:{width:'100px',height:'100px',objectFit:'cover',borderRadius:'50%',backgroundColor:'#333333'},backgroundPicture:{width:'100%',height:'150px',objectFit:'cover',borderRadius:theme.spacing(0,0,2,2),marginTop:theme.spacing(3)},pictures:{display:'flex',flexDirection:'column',alignItems:'center'},userIcon:{color:'#ea5970',margin:theme.spacing(1)},inputImage:{display:'none'},fieldWarning:{color:'#ea5970',fontSize:'0.8rem',marginTop:theme.spacing(1)}};});var defaultProfilePic='https://image.freepik.com/vector-gratis/perfil-avatar-hombre-icono-redondo_24640-14044.jpg';var defaultCoverPic='https://png.pngtree.com/thumb_back/fw800/background/20190220/ourmid/pngtree-blue-gradient-summer-creative-image_9270.jpg';export var EditInfo=function EditInfo(props){var user=props.user,setUser=props.setUser,handleClose=props.handleClose;var classes=useStyles();var inputProfileRef=useRef();var inputCoverRef=useRef();var _useState=useState({userName:user.userName,tag:user.tag,email:user.email,changedProfilePic:false,profilePic:null,profilePicPreview:user.profilePicPath,changedCoverPic:false,coverPic:null,coverPicPreview:user.coverPicPath}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var _useState3=useState({userName:false,tag:false,email:false,validated:false}),_useState4=_slicedToArray(_useState3,2),validation=_useState4[0],setValidation=_useState4[1];useEffect(function(){setValidation(validateUpdateUser(state));},[state]);var onChangeTextField=function onChangeTextField(e){setState(_objectSpread(_objectSpread({},state),{},_defineProperty({},e.target.name,e.target.value)));};var onChangeProfilePic=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var file,url;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:file=e.target.files[0];if(file){_context.next=3;break;}return _context.abrupt(\"return\");case 3:_context.next=5;return fileToBase64(file);case 5:url=_context.sent;setState(function(x){var copy=_objectSpread({},x);copy.profilePicPreview=url;copy.changedProfilePic=true;copy.profilePic=file;return copy;});case 7:case\"end\":return _context.stop();}}},_callee);}));return function onChangeProfilePic(_x){return _ref.apply(this,arguments);};}();var onChangeCoverPic=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var file,url;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:file=e.target.files[0];if(file){_context2.next=3;break;}return _context2.abrupt(\"return\");case 3:_context2.next=5;return fileToBase64(file);case 5:url=_context2.sent;setState(function(x){var copy=_objectSpread({},x);copy.coverPicPreview=url;copy.changedCoverPic=true;copy.coverPic=file;return copy;});case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function onChangeCoverPic(_x2){return _ref2.apply(this,arguments);};}();var onClickProfilePic=function onClickProfilePic(){var _inputProfileRef$curr;return(_inputProfileRef$curr=inputProfileRef.current)===null||_inputProfileRef$curr===void 0?void 0:_inputProfileRef$curr.click();};var onClickCoverPic=function onClickCoverPic(){var _inputCoverRef$curren;return(_inputCoverRef$curren=inputCoverRef.current)===null||_inputCoverRef$curren===void 0?void 0:_inputCoverRef$curren.click();};var onSubmit=function onSubmit(e){e.preventDefault();var model=new UpdateUserViewModel(state);updateUser(authenticationService.currentUserValue.id,model).then(handleResponse).then(function(res){var data=res.data;setUser(data);handleClose();authenticationService.logout();}).catch(console.warn);};return/*#__PURE__*/_jsxs(Container,{component:\"main\",maxWidth:\"xs\",children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsxs(\"div\",{className:classes.paper,children:[/*#__PURE__*/_jsx(AccountCircle,{className:classes.userIcon}),/*#__PURE__*/_jsx(Typography,{component:\"h1\",variant:\"h5\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"Mi Perfil\"})}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:\"Actualizar informaci\\xF3n.\"}),/*#__PURE__*/_jsxs(\"form\",{className:classes.form,onSubmit:onSubmit,noValidate:true,children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,className:classes.pictures,children:/*#__PURE__*/_jsx(\"img\",{className:classes.profilePicture,src:state.profilePicPreview||defaultProfilePic})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,className:classes.pictures,children:[/*#__PURE__*/_jsx(\"input\",{accept:\"image/*\",className:classes.input,type:\"file\",ref:inputProfileRef,onChange:onChangeProfilePic}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"profile-button-file\",children:[\" Foto de perfil\",/*#__PURE__*/_jsx(IconButton,{color:\"secondary\",\"aria-label\":\"upload picture\",component:\"span\",onClick:onClickProfilePic,children:/*#__PURE__*/_jsx(ImageIcon,{className:classes.imageIcon})})]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,sm:6,children:[/*#__PURE__*/_jsx(TextField,{name:\"userName\",autoComplete:\"fname\",variant:\"outlined\",required:true,fullWidth:true,value:state.userName,onChange:onChangeTextField,label:\"Usuario\",autoFocus:true}),!validation.userName&&/*#__PURE__*/_jsx(Typography,{variant:\"body2\",className:classes.fieldWarning,children:\"* Nombre de Usuario no valido\"})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,sm:6,children:[/*#__PURE__*/_jsx(TextField,{name:\"tag\",variant:\"outlined\",required:true,fullWidth:true,label:\"Tag\",value:state.tag,onChange:onChangeTextField,autoComplete:\"tagname\"}),!validation.tag&&/*#__PURE__*/_jsx(Typography,{variant:\"body2\",className:classes.fieldWarning,children:\"* Tag no valido\"})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(TextField,{name:\"email\",variant:\"outlined\",required:true,fullWidth:true,label:\"Email\",value:state.email,onChange:onChangeTextField,autoComplete:\"email\"}),!validation.email&&/*#__PURE__*/_jsx(Typography,{variant:\"body2\",className:classes.fieldWarning,children:\"* Email no valido\"})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,className:classes.pictures,children:/*#__PURE__*/_jsx(\"img\",{className:classes.backgroundPicture,src:state.coverPicPreview||defaultCoverPic})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,className:classes.pictures,children:[/*#__PURE__*/_jsx(\"input\",{accept:\"image/*\",className:classes.input,type:\"file\",ref:inputCoverRef,onChange:onChangeCoverPic}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"background-button-file\",children:[\" Foto de portada\",/*#__PURE__*/_jsx(IconButton,{color:\"secondary\",\"aria-label\":\"upload picture\",component:\"span\",onClick:onClickCoverPic,children:/*#__PURE__*/_jsx(ImageIcon,{className:classes.imageIcon})})]})]})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",color:\"primary\",className:classes.submit,disabled:!validation.validated,children:\"Guardar informaci\\xF3n\"})]})]})]});};export default EditInfo;","map":{"version":3,"sources":["D:/Repositories/Visual C++/PosThis-React-app/src/components/EditProfile/EditInfo.js"],"names":["React","useState","useEffect","useRef","Button","CssBaseline","TextField","Grid","Typography","Container","IconButton","Image","ImageIcon","AccountCircle","makeStyles","updateUser","fileToBase64","validateUpdateUser","handleResponse","authenticationService","UpdateUserViewModel","useStyles","theme","paper","display","flexDirection","alignItems","avatar","margin","spacing","backgroundColor","palette","primary","main","form","width","marginTop","submit","input","profilePicture","height","objectFit","borderRadius","backgroundPicture","pictures","userIcon","color","inputImage","fieldWarning","fontSize","defaultProfilePic","defaultCoverPic","EditInfo","props","user","setUser","handleClose","classes","inputProfileRef","inputCoverRef","userName","tag","email","changedProfilePic","profilePic","profilePicPreview","profilePicPath","changedCoverPic","coverPic","coverPicPreview","coverPicPath","state","setState","validated","validation","setValidation","onChangeTextField","e","target","name","value","onChangeProfilePic","file","files","url","x","copy","onChangeCoverPic","onClickProfilePic","current","click","onClickCoverPic","onSubmit","preventDefault","model","currentUserValue","id","then","res","data","logout","catch","console","warn","imageIcon"],"mappings":"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","sourcesContent":["import React,{ useState, useEffect, useRef } from 'react';\r\n\r\nimport {\r\n    Button,\r\n    CssBaseline,\r\n    TextField,\r\n    Grid,\r\n    Typography,\r\n    Container,\r\n    IconButton,\r\n}from  '@material-ui/core';\r\n\r\nimport {\r\n  Image as ImageIcon,\r\n  AccountCircle\r\n}from '@material-ui/icons'\r\n\r\nimport { makeStyles }     from '@material-ui/core/styles';\r\n\r\nimport { updateUser }                           from '_api';\r\nimport { fileToBase64, validateUpdateUser }     from '_utils';\r\nimport { handleResponse }                       from '_helpers';\r\nimport { authenticationService }                from '_services';    \r\n\r\nimport { UpdateUserViewModel }                  from '_model';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  paper: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.primary.main,\r\n  },\r\n  form: {\r\n    width: '100%', \r\n    marginTop: theme.spacing(3),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2)\r\n  },\r\n  input:{\r\n    display: 'none',\r\n  },\r\n  profilePicture:{\r\n    width:            '100px',\r\n    height:           '100px',\r\n    objectFit:        'cover',\r\n    borderRadius:     '50%',\r\n    backgroundColor:  '#333333'\r\n  },\r\n  backgroundPicture:{\r\n    width:            '100%',\r\n    height:           '150px',\r\n    objectFit:        'cover',\r\n    borderRadius:     theme.spacing(0, 0, 2, 2),\r\n    \r\n    marginTop:theme.spacing(3),\r\n  },\r\n  pictures: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  userIcon:{\r\n    color: '#ea5970',\r\n    margin: theme.spacing(1),\r\n  },\r\n  inputImage:{\r\n    display: 'none'\r\n  },\r\n  fieldWarning:{\r\n    color: '#ea5970',\r\n    fontSize: '0.8rem',\r\n    marginTop: theme.spacing(1)\r\n  }\r\n}));\r\n\r\nconst defaultProfilePic = 'https://image.freepik.com/vector-gratis/perfil-avatar-hombre-icono-redondo_24640-14044.jpg';\r\nconst defaultCoverPic   = 'https://png.pngtree.com/thumb_back/fw800/background/20190220/ourmid/pngtree-blue-gradient-summer-creative-image_9270.jpg';\r\n\r\nexport const EditInfo = ( props ) => {\r\n\r\n  const { user, setUser, handleClose } = props;\r\n\r\n  const classes           = useStyles();\r\n\r\n  const inputProfileRef   = useRef();\r\n  const inputCoverRef     = useRef();\r\n\r\n  const [state, setState] = useState({\r\n    userName:           user.userName,\r\n    tag:                user.tag,\r\n    email:              user.email,\r\n    changedProfilePic:  false,\r\n    profilePic:         null,\r\n    profilePicPreview:  user.profilePicPath,\r\n    changedCoverPic:    false,\r\n    coverPic:           null,\r\n    coverPicPreview:    user.coverPicPath,\r\n  });\r\n\r\n  const [validation, setValidation]= useState({\r\n    userName:   false,\r\n    tag:        false,\r\n    email:      false,\r\n    validated:  false,\r\n  });\r\n\r\n  useEffect(()=>{\r\n    setValidation( validateUpdateUser( state ) );\r\n  },[state]);\r\n\r\n  const onChangeTextField = e=>{\r\n    setState({\r\n      ...state,\r\n      [e.target.name]: e.target.value\r\n    });\r\n  };\r\n\r\n  const onChangeProfilePic = async (e) => {\r\n    let file = e.target.files[0];\r\n\r\n    if( !file )\r\n      return;\r\n\r\n    let url  = await fileToBase64(file);\r\n    setState( x=>{\r\n      let copy = {...x};\r\n      copy.profilePicPreview = url;\r\n      copy.changedProfilePic = true;\r\n      copy.profilePic        = file;\r\n      return copy;\r\n    })\r\n  };\r\n\r\n  const onChangeCoverPic   = async (e) => {\r\n    let file = e.target.files[0];\r\n\r\n    if( !file )\r\n      return;\r\n      \r\n    let url  = await fileToBase64(file);\r\n    setState( x=>{\r\n      let copy = {...x};\r\n      copy.coverPicPreview = url;\r\n      copy.changedCoverPic = true;\r\n      copy.coverPic        = file;\r\n      return copy;\r\n    })\r\n  };\r\n\r\n  const onClickProfilePic = () => inputProfileRef.current?.click();\r\n \r\n  const onClickCoverPic   = () => inputCoverRef  .current?.click();\r\n\r\n  const onSubmit = e=>{\r\n    e.preventDefault();\r\n\r\n    let model = new UpdateUserViewModel(state);\r\n\r\n    updateUser(authenticationService.currentUserValue.id, model)\r\n      .then( handleResponse )\r\n      .then( res =>{\r\n        const { data } = res;\r\n        setUser( data );\r\n        handleClose();\r\n        authenticationService.logout();\r\n      })\r\n      .catch( console.warn );\r\n  };\r\n  \r\n  return (\r\n    <Container component='main' maxWidth='xs'>\r\n      <CssBaseline />\r\n      <div className={classes.paper}>\r\n\r\n        <AccountCircle className={classes.userIcon}/>\r\n\r\n        <Typography component='h1' variant='h5'>\r\n          <strong>Mi Perfil</strong>\r\n        </Typography>\r\n\r\n        <Typography variant='body2'>\r\n          Actualizar información.\r\n        </Typography>\r\n\r\n        <form className={classes.form} onSubmit={onSubmit} noValidate>\r\n\r\n          <Grid container spacing={2}>\r\n\r\n            <Grid item xs={12} className={classes.pictures}>\r\n              <img className={classes.profilePicture} src={ state.profilePicPreview || defaultProfilePic}/>\r\n            </Grid>\r\n           \r\n            <Grid item xs={12}   className={classes.pictures}>\r\n              <input \r\n                accept='image/*' \r\n                className={classes.input} \r\n                type='file' ref={inputProfileRef} \r\n                onChange={onChangeProfilePic}\r\n              />\r\n              <label htmlFor='profile-button-file'> Foto de perfil\r\n                <IconButton \r\n                 color='secondary' \r\n                 aria-label='upload picture' \r\n                 component='span' \r\n                 onClick={onClickProfilePic}\r\n                >\r\n                  <ImageIcon className={classes.imageIcon}/>\r\n                </IconButton>\r\n              </label>\r\n            </Grid>\r\n          \r\n            <Grid item xs={12} sm={6}>\r\n              <TextField\r\n                name='userName'\r\n                autoComplete='fname'\r\n                variant='outlined'\r\n                required\r\n                fullWidth\r\n                value={state.userName}\r\n                onChange={onChangeTextField}\r\n                label='Usuario'\r\n                autoFocus\r\n              />\r\n              {\r\n                !validation.userName\r\n                && \r\n                <Typography variant='body2' className={classes.fieldWarning}>\r\n                * Nombre de Usuario no valido\r\n                </Typography>\r\n              }\r\n            </Grid>\r\n\r\n            <Grid item xs={12} sm={6}>\r\n              <TextField\r\n                name='tag'\r\n                variant='outlined'\r\n                required\r\n                fullWidth\r\n                label='Tag'\r\n                value={state.tag}\r\n                onChange={onChangeTextField}\r\n                autoComplete='tagname'\r\n              />\r\n              {\r\n                !validation.tag\r\n                && \r\n                <Typography variant='body2' className={classes.fieldWarning}>\r\n                * Tag no valido\r\n                </Typography>\r\n              }\r\n            </Grid>\r\n\r\n            <Grid item xs={12}>\r\n              <TextField\r\n                name='email'\r\n                variant='outlined'\r\n                required\r\n                fullWidth\r\n                label='Email'\r\n                value={state.email}\r\n                onChange = {onChangeTextField}\r\n                autoComplete='email'\r\n              />\r\n              {\r\n                !validation.email\r\n                && \r\n                <Typography variant='body2' className={classes.fieldWarning}>\r\n                * Email no valido\r\n                </Typography>\r\n              }\r\n            </Grid>\r\n\r\n            <Grid item xs={12} className={classes.pictures}>\r\n              <img className={classes.backgroundPicture} src={ state.coverPicPreview || defaultCoverPic }/>\r\n            </Grid>\r\n    \r\n            <Grid item xs={12} className={classes.pictures}>\r\n              <input \r\n               accept='image/*' \r\n               className={classes.input} \r\n               type='file' \r\n               ref={inputCoverRef} \r\n               onChange={onChangeCoverPic}\r\n              />\r\n              <label htmlFor='background-button-file'> Foto de portada\r\n                <IconButton \r\n                 color='secondary' \r\n                 aria-label='upload picture' \r\n                 component='span' \r\n                 onClick={onClickCoverPic}\r\n                >\r\n                  <ImageIcon className={classes.imageIcon}/>\r\n                </IconButton>\r\n              </label>\r\n            </Grid>\r\n\r\n          </Grid>\r\n\r\n          <Button\r\n            type      ='submit'\r\n            fullWidth\r\n            variant   ='contained'\r\n            color     ='primary'\r\n            className ={classes.submit}\r\n            disabled  = {!validation.validated}\r\n          >\r\n            Guardar información\r\n          </Button>\r\n        </form>\r\n      </div>\r\n      \r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default  EditInfo;"]},"metadata":{},"sourceType":"module"}