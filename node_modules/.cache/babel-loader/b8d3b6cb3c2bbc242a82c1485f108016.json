{"ast":null,"code":"import _regeneratorRuntime from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _defineProperty from\"D:/Repositories/Visual C++/PosThis-React-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import React,{useState,useRef}from'react';import{Link}from'react-router-dom';import{makeStyles}from'@material-ui/core/styles';import{red}from'@material-ui/core/colors';import{Card,CardActions,CardContent,Typography,IconButton,Button,Avatar}from'@material-ui/core';import{Favorite as FavoriteIcon,QuestionAnswer as QuestionAnswerIcon,ReplyAll as ReplyAllIcon,Save as SaveIcon,Image as ImageIcon}from'@material-ui/icons';import{MediaGrid}from'components/Media';import{handleResponse}from'_helpers';import{authenticationService}from'_services';import{routes,fileToBase64}from'_utils';import{updatePost,deletePost,createLike,deleteLike,createRepost,deleteRepost}from'_api';import{UPostModel,LikeViewModel,RepostViewModel}from'_model';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){var _ref;return _ref={root:_defineProperty({width:'100%',maxWidth:'600px',marginTop:theme.spacing(3),backgroundColor:'#2b387f',boxShadow:'black 1px 1px 8px',borderRadius:theme.spacing(1,1,0,0)},theme.breakpoints.down('sm'),{}),media:{height:'140px'},cardBtn:{alignItems:'center',justifyContent:'space-around',color:'white'},repostText:{color:'white',padding:theme.spacing(2,4)},title:{display:'inline-block',width:'auto',color:'white',marginLeft:theme.spacing(2),textDecoration:'none','&:visited':{color:'white'}},content:{color:'white',marginLeft:theme.spacing(7),marginBottom:theme.spacing(1),textIndent:'0',whiteSpace:'pre-wrap'},contentNoMedia:{color:'white',marginLeft:theme.spacing(7),marginBottom:theme.spacing(1),fontSize:'1.3rem',textIndent:'0',whiteSpace:'pre-wrap'},contentEdit:{color:'white',marginBottom:theme.spacing(1),background:'transparent',outline:'none',width:'100%',height:'70px',resize:'none',textDecoration:'underline',boxSizing:'border-box',whiteSpace:'pre-wrap'},likeIcon:{color:red[500]},commentIcon:{color:'#ea5970'},repostIcon:{color:'#f28a9a'},saveIcon:{color:'#33eaff'},mediaIcon:{color:'#ea5970'},displayTitle:{display:'inline-flex'},imgPost:{maxWidth:'450'},contMedia:{display:'flex',flexDirection:'column',flexWrap:'wrap'},contImg:{display:'inline-block',flexGrow:1,alignItems:'center',textAlign:'center'},mediaMask:_defineProperty({display:'inline-block',position:'relative',width:'100%',height:'400px',overflow:'hidden'},theme.breakpoints.down('sm'),{height:'300px'})},_defineProperty(_ref,\"media\",{display:'inline-block',position:'absolute',top:'50%',left:'50%',transform:'translate( -50%, -50%)',width:'100%'}),_defineProperty(_ref,\"usertag\",{color:'white'}),_defineProperty(_ref,\"displaybtn\",{textAlign:'right',marginTop:theme.spacing(2)}),_defineProperty(_ref,\"input\",{display:'none'}),_defineProperty(_ref,\"date\",{fontSize:'0.7rem',color:'gray',display:'block'}),_defineProperty(_ref,\"grayIcon\",{color:'gray'}),_defineProperty(_ref,\"avatar\",{backgroundColor:'#333333',border:'1px solid #f28a9a'}),_defineProperty(_ref,\"repostUserLink\",{color:'white',textDecoration:'none','&:visited':{color:'white'},'&:hover':{color:'##ea5970'}}),_defineProperty(_ref,\"deleteBtn\",{marginRight:theme.spacing(2)}),_ref;});export var PostCard=function PostCard(props){var history=props.history;var _useState=useState(props.post),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var _useState3=useState({editMode:false,content:post.content,originalContent:post.content,medias:post.medias,originalMedias:post.medias,deleted:[],newMedias:[]}),_useState4=_slicedToArray(_useState3,2),state=_useState4[0],setState=_useState4[1];var classes=useStyles();var inputFileRef=useRef();var temp={state:state,setState:setState};var onClickSave=function onClickSave(){updatePost(post.postID,new UPostModel({content:state.content,deleted:state.deleted,files:state.newMedias})).then(handleResponse).then(function(res){var data=res.data;setState(function(x){var copy=_objectSpread({},x);copy.editMode=false;copy.originalContent=copy.content;copy.medias=data.medias;copy.originalMedias=data.medias;return copy;});}).catch(function(res){console.log('err',res);});};var onChangeContent=function onChangeContent(e){setState(function(x){var copy=_objectSpread({},x);copy.content=e.target.value;return copy;});};var onChangeImages=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var files,mediaInfo,newMediaFiles,i,file,preview,mediaViewModel;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:files=e.target.files;if(!(state.medias.length+files.length>4)){_context.next=3;break;}return _context.abrupt(\"return\");case 3:mediaInfo=[];newMediaFiles=[];i=0;case 6:if(!(i<files.length)){_context.next=17;break;}file=files[i];_context.next=10;return fileToBase64(file);case 10:preview=_context.sent;mediaViewModel={mediaID:null,mime:file.type,path:preview,isVideo:file.type.includes('video')};mediaInfo.push(mediaViewModel);newMediaFiles.push(file);case 14:i++;_context.next=6;break;case 17:setState(function(x){var copy=_objectSpread({},x);copy.medias=[].concat(_toConsumableArray(copy.medias),mediaInfo);copy.newMedias=[].concat(_toConsumableArray(copy.newMedias),newMediaFiles);return copy;});case 18:case\"end\":return _context.stop();}}},_callee);}));return function onChangeImages(_x){return _ref2.apply(this,arguments);};}();var onClickFileOpen=function onClickFileOpen(){var _inputFileRef$current;return(_inputFileRef$current=inputFileRef.current)===null||_inputFileRef$current===void 0?void 0:_inputFileRef$current.click();};var onClickLike=function onClickLike(){var model=new LikeViewModel({postID:post.postID,userID:authenticationService.currentUserValue.id});if(post.isLiked){deleteLike(model).then(handleResponse).then(function(res){var data=res.data;setPost(data);setState(function(x){var copy=_objectSpread({},x);copy.content=data.content;copy.originalContent=data.content;copy.medias=data.medias;copy.originalMedias=data.medias;return copy;});}).catch(console.warn);}else{createLike(model).then(handleResponse).then(function(res){var data=res.data;setPost(data);setState(function(x){var copy=_objectSpread({},x);copy.content=data.content;copy.originalContent=data.content;copy.medias=data.medias;copy.originalMedias=data.medias;return copy;});}).catch(console.warn);}};var onClickRepost=function onClickRepost(){var model=new RepostViewModel({postID:post.postID,userID:authenticationService.currentUserValue.id});if(post.isReposted){deleteRepost(model).then(handleResponse).then(function(res){var data=res.data;setPost(data);setState(function(x){var copy=_objectSpread({},x);copy.content=data.content;copy.originalContent=data.content;copy.medias=data.medias;copy.originalMedias=data.medias;return copy;});}).catch(console.warn);}else{createRepost(model).then(handleResponse).then(function(res){var data=res.data;setPost(data);setState(function(x){var copy=_objectSpread({},x);copy.content=data.content;copy.originalContent=data.content;copy.medias=data.medias;copy.originalMedias=data.medias;return copy;});}).catch(console.warn);}};var onToggleEditMode=function onToggleEditMode(){setState(function(x){var copy=_objectSpread({},x);copy.editMode=!copy.editMode;if(copy.editMode===false){copy.medias=_toConsumableArray(copy.originalMedias);copy.content=copy.originalContent;copy.deleted=[];copy.newMedias=[];}return copy;});};var onClickDelete=function onClickDelete(){if(window.confirm('Seguro que quiere borrar el post')){deletePost(post.postID).then(handleResponse).then(function(res){history.replace(routes.feed);}).catch(console.warn);}};var dateString=new Date(Date.parse(post.date)).toLocaleString();return/*#__PURE__*/_jsxs(Card,{className:classes.root,children:[post.isRepost&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",className:classes.repostText,children:[/*#__PURE__*/_jsx(Link,{to:routes.getProfile(post.publisherID),className:classes.repostUserLink,children:post.reposterUserName}),\" reposted this!\"]}),/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.displayTitle,children:[/*#__PURE__*/_jsx(Link,{to:routes.getProfile(post.publisherID),children:/*#__PURE__*/_jsx(Avatar,{src:post.publisherProfilePic,className:classes.avatar})}),/*#__PURE__*/_jsx(Link,{to:routes.getProfile(post.publisherID),children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",component:\"h2\",className:classes.title,children:/*#__PURE__*/_jsxs(\"strong\",{children:[post.publisherUserName,\" \",'@'+post.publisherTag]})})})]}),/*#__PURE__*/_jsxs(\"p\",{className:classes.date,children:[dateString.slice(0,dateString.length-6),\" \",dateString.slice(dateString.length-3)]}),state.editMode?/*#__PURE__*/_jsx(\"textarea\",{className:classes.contentEdit,value:state.content,onChange:onChangeContent}):/*#__PURE__*/_jsx(Typography,{variant:\"body2\",component:\"p\",className:state.medias.length!==0?classes.content:classes.contentNoMedia,children:state.originalContent}),state.editMode&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{accept:\"image/*\",className:classes.input,type:\"file\",multiple:true,ref:inputFileRef,onChange:onChangeImages}),/*#__PURE__*/_jsx(IconButton,{onClick:onClickFileOpen,children:/*#__PURE__*/_jsx(ImageIcon,{className:classes.mediaIcon})})]}),/*#__PURE__*/_jsx(\"div\",{className:classes.contMedia,children:/*#__PURE__*/_jsx(MediaGrid,_objectSpread({media:state.editMode?state.medias:state.originalMedias},temp))}),/*#__PURE__*/_jsx(\"div\",{className:classes.displaybtn,children:authenticationService.currentUserValue.id===post.publisherID&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"secondary\",onClick:onClickDelete,className:classes.deleteBtn,children:\"Eliminar\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"secondary\",onClick:onToggleEditMode,children:state.editMode?'Cancelar':'Editar'})]})})]}),/*#__PURE__*/_jsxs(CardActions,{disableSpacing:true,className:classes.cardBtn,children:[!state.editMode&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(IconButton,{onClick:onClickLike,children:/*#__PURE__*/_jsx(FavoriteIcon,{className:post.isLiked?classes.likeIcon:classes.grayIcon})}),post.likeCount]}),!state.editMode&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Link,{to:routes.getPost(post.postID||1),children:/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsx(QuestionAnswerIcon,{className:classes.commentIcon})})}),post.replyCount]}),!state.editMode&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(IconButton,{onClick:onClickRepost,children:/*#__PURE__*/_jsx(ReplyAllIcon,{className:post.isReposted?classes.repostIcon:classes.grayIcon})}),post.repostCount]}),authenticationService.currentUserValue.id===post.publisherID&&state.editMode&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(IconButton,{onClick:onClickSave,children:/*#__PURE__*/_jsx(SaveIcon,{className:classes.saveIcon})})})]})]});};export default PostCard;","map":{"version":3,"sources":["D:/Repositories/Visual C++/PosThis-React-app/src/components/Post/PostCard.js"],"names":["React","useState","useRef","Link","makeStyles","red","Card","CardActions","CardContent","Typography","IconButton","Button","Avatar","Favorite","FavoriteIcon","QuestionAnswer","QuestionAnswerIcon","ReplyAll","ReplyAllIcon","Save","SaveIcon","Image","ImageIcon","MediaGrid","handleResponse","authenticationService","routes","fileToBase64","updatePost","deletePost","createLike","deleteLike","createRepost","deleteRepost","UPostModel","LikeViewModel","RepostViewModel","useStyles","theme","root","width","maxWidth","marginTop","spacing","backgroundColor","boxShadow","borderRadius","breakpoints","down","media","height","cardBtn","alignItems","justifyContent","color","repostText","padding","title","display","marginLeft","textDecoration","content","marginBottom","textIndent","whiteSpace","contentNoMedia","fontSize","contentEdit","background","outline","resize","boxSizing","likeIcon","commentIcon","repostIcon","saveIcon","mediaIcon","displayTitle","imgPost","contMedia","flexDirection","flexWrap","contImg","flexGrow","textAlign","mediaMask","position","overflow","top","left","transform","border","marginRight","PostCard","props","history","post","setPost","editMode","originalContent","medias","originalMedias","deleted","newMedias","state","setState","classes","inputFileRef","temp","onClickSave","postID","files","then","res","data","x","copy","catch","console","log","onChangeContent","e","target","value","onChangeImages","length","mediaInfo","newMediaFiles","i","file","preview","mediaViewModel","mediaID","mime","type","path","isVideo","includes","push","onClickFileOpen","current","click","onClickLike","model","userID","currentUserValue","id","isLiked","warn","onClickRepost","isReposted","onToggleEditMode","onClickDelete","window","confirm","replace","feed","dateString","Date","parse","date","toLocaleString","isRepost","getProfile","publisherID","repostUserLink","reposterUserName","publisherProfilePic","avatar","publisherUserName","publisherTag","slice","input","displaybtn","deleteBtn","grayIcon","likeCount","getPost","replyCount","repostCount"],"mappings":"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","sourcesContent":["import React, { useState, useRef }  from 'react';\r\nimport { Link }                     from 'react-router-dom';\r\n\r\nimport { makeStyles }               from '@material-ui/core/styles';\r\nimport { red }                      from '@material-ui/core/colors';\r\n\r\nimport {\r\n  Card,\r\n  CardActions,\r\n  CardContent,\r\n  Typography,\r\n  IconButton,\r\n  Button,\r\n  Avatar,\r\n} from '@material-ui/core';\r\n\r\nimport {\r\n  Favorite as FavoriteIcon,\r\n  QuestionAnswer as QuestionAnswerIcon,\r\n  ReplyAll       as ReplyAllIcon,\r\n  Save           as SaveIcon,\r\n  Image          as ImageIcon,\r\n\r\n} from '@material-ui/icons';\r\n\r\nimport { MediaGrid }                from 'components/Media';\r\n\r\nimport { handleResponse }  from '_helpers';\r\nimport { authenticationService }    from '_services';\r\nimport { routes, fileToBase64 }     from '_utils';\r\n\r\nimport { \r\n  updatePost,\r\n  deletePost,\r\n  createLike,\r\n  deleteLike,\r\n  createRepost,\r\n  deleteRepost\r\n} from '_api';\r\n\r\nimport{\r\n  UPostModel,\r\n  LikeViewModel,\r\n  RepostViewModel\r\n} from '_model';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    width:            '100%',\r\n    maxWidth:         '600px',\r\n    marginTop:         theme.spacing( 3 ),\r\n    backgroundColor:  '#2b387f',\r\n    boxShadow:        'black 1px 1px 8px',\r\n    borderRadius:     theme.spacing( 1, 1, 0, 0 ),\r\n    [theme.breakpoints.down('sm')]:{\r\n    }\r\n  },\r\n  media: {\r\n    height: '140px',\r\n  },\r\n  cardBtn: {\r\n    alignItems:     'center',\r\n    justifyContent: 'space-around',\r\n    color:          'white',\r\n  },\r\n  repostText:{\r\n    color:    'white',\r\n    padding:  theme.spacing(2, 4)\r\n  },\r\n  title: {\r\n    display:        'inline-block',\r\n    width:          'auto',\r\n    color:          'white',\r\n    marginLeft:     theme.spacing(2),\r\n    textDecoration: 'none',\r\n    '&:visited':{\r\n      color: 'white',\r\n    }\r\n  },\r\n  content: {\r\n    color:        'white',\r\n    marginLeft:   theme.spacing(7),\r\n    marginBottom: theme.spacing(1),\r\n    textIndent:   '0',\r\n    whiteSpace:   'pre-wrap'\r\n  },\r\n  contentNoMedia:{\r\n    color:        'white',\r\n    marginLeft:   theme.spacing(7),\r\n    marginBottom: theme.spacing(1),\r\n    fontSize:     '1.3rem',\r\n    textIndent:   '0',\r\n    whiteSpace:   'pre-wrap'\r\n  },\r\n  contentEdit: {\r\n    color:          'white',\r\n    marginBottom:   theme.spacing(1),\r\n    background:     'transparent',\r\n    outline:        'none',\r\n    width:          '100%',\r\n    height:         '70px',\r\n    resize:         'none',\r\n    textDecoration: 'underline',\r\n    boxSizing:      'border-box',\r\n    whiteSpace:     'pre-wrap'\r\n  },\r\n  likeIcon:{\r\n    color: red[500],\r\n  },\r\n  commentIcon:{\r\n    color: '#ea5970',\r\n  },\r\n  repostIcon:{\r\n    color: '#f28a9a',\r\n  },\r\n  saveIcon:{\r\n    color: '#33eaff',\r\n  },\r\n  mediaIcon:{\r\n    color: '#ea5970'\r\n  },\r\n  displayTitle:{\r\n    display: 'inline-flex'\r\n  },\r\n  imgPost:{\r\n    maxWidth: '450',\r\n  },\r\n  contMedia:{\r\n    display:        'flex',\r\n    flexDirection:  'column',\r\n    flexWrap:       'wrap'\r\n  },\r\n  contImg:{\r\n    display:      'inline-block',\r\n    flexGrow:     1,\r\n    alignItems:   'center',\r\n    textAlign:    'center',\r\n  },\r\n  mediaMask:{\r\n    display:      'inline-block',\r\n    position:     'relative',\r\n    width:        '100%',\r\n    height:       '400px',\r\n    overflow:     'hidden',\r\n    [theme.breakpoints.down('sm')]:{\r\n      height: '300px'\r\n    }\r\n  },\r\n  media:{\r\n    display:    'inline-block',\r\n    position:   'absolute',\r\n    top:        '50%',\r\n    left:       '50%',\r\n    transform:  'translate( -50%, -50%)',\r\n    width:      '100%',\r\n  },\r\n  usertag:{\r\n    color: 'white',\r\n  },\r\n  displaybtn:{\r\n    textAlign: 'right',\r\n    marginTop: theme.spacing(2),\r\n  },\r\n  input:{\r\n    display: 'none'\r\n  },\r\n  date:{\r\n    fontSize: '0.7rem',\r\n    color:    'gray',\r\n    display:  'block'\r\n  },\r\n  grayIcon:{\r\n    color: 'gray'\r\n  },\r\n  avatar:{\r\n    backgroundColor: '#333333',\r\n    border: '1px solid #f28a9a'\r\n  },\r\n  repostUserLink:{\r\n    color: 'white',\r\n    textDecoration: 'none',\r\n    '&:visited':{\r\n      color: 'white'\r\n    },\r\n    '&:hover':{\r\n      color: '##ea5970'\r\n    }\r\n  },\r\n  deleteBtn:{\r\n    marginRight: theme.spacing(2)\r\n  }\r\n}));\r\n\r\nexport const PostCard = ( props ) => {\r\n\r\n  const { history } = props;\r\n\r\n  const [ post, setPost ] = useState( props.post );\r\n\r\n  const [ state, setState ] = useState({\r\n    editMode:         false,\r\n    content:          post.content,\r\n    originalContent:  post.content,\r\n    medias:           post.medias,\r\n    originalMedias:   post.medias,\r\n    deleted:          [],\r\n    newMedias:        []\r\n  });\r\n\r\n  const classes = useStyles();\r\n  const inputFileRef = useRef();\r\n\r\n  const temp = { state, setState };\r\n\r\n  const onClickSave = ()=>{\r\n    updatePost( post.postID,  new UPostModel({content: state.content, deleted: state.deleted, files: state.newMedias}))\r\n      .then( handleResponse )\r\n      .then( res =>{\r\n\r\n        let { data } = res;\r\n\r\n        setState(x=>{\r\n          let copy              = {...x};\r\n          copy.editMode         = false;\r\n          copy.originalContent  = copy.content;\r\n          copy.medias           = data.medias;\r\n          copy.originalMedias   = data.medias;\r\n          return copy;\r\n        });\r\n      })\r\n      .catch( res =>{\r\n        console.log('err',res)\r\n      });\r\n  };\r\n  \r\n  const onChangeContent = e=>{\r\n      setState( x =>{\r\n        let copy = {...x};\r\n        copy.content = e.target.value;\r\n        return copy;\r\n      });\r\n  };\r\n\r\n  const onChangeImages = async e=>{\r\n    let {files} = e.target;\r\n\r\n    if( state.medias.length + files.length > 4 )\r\n      return;\r\n\r\n    const mediaInfo    = [];\r\n    const newMediaFiles = [];\r\n    for ( let i = 0; i < files.length; i++ ){\r\n      let file = files[i];\r\n      let preview = await fileToBase64( file );\r\n\r\n      const mediaViewModel = {\r\n        mediaID:  null,\r\n        mime:     file.type,\r\n        path:     preview,\r\n        isVideo:  file.type.includes('video')\r\n      };\r\n\r\n      mediaInfo     .push( mediaViewModel );\r\n      newMediaFiles .push( file );\r\n    }\r\n\r\n    setState( x=>{\r\n      let copy = {...x};\r\n      copy.medias = [...copy.medias, ...mediaInfo];\r\n      copy.newMedias = [...copy.newMedias, ...newMediaFiles];\r\n      return copy;\r\n    });\r\n  };\r\n\r\n  const onClickFileOpen = ()=>inputFileRef.current?.click();\r\n\r\n  const onClickLike = ()=>{\r\n\r\n    const model = new LikeViewModel({\r\n      postID: post.postID, \r\n      userID: authenticationService.currentUserValue.id \r\n     });\r\n\r\n    if( post.isLiked ){\r\n      deleteLike(model)\r\n       .then(handleResponse)\r\n       .then( res =>{\r\n         const { data } = res;\r\n         setPost( data );\r\n         setState( x=>{\r\n          let copy = {...x};\r\n          copy.content         = data.content;\r\n          copy.originalContent = data.content;\r\n          copy.medias          = data.medias;\r\n          copy.originalMedias  = data.medias;\r\n          return copy;\r\n        });\r\n       })\r\n       .catch(console.warn)\r\n    }\r\n    else{\r\n      createLike(model)\r\n        .then(handleResponse)\r\n        .then(res=>{\r\n          const { data } = res;\r\n          setPost( data );\r\n          setState( x=>{\r\n            let copy = {...x};\r\n            copy.content         = data.content;\r\n            copy.originalContent = data.content;\r\n            copy.medias          = data.medias;\r\n            copy.originalMedias  = data.medias;\r\n            return copy;\r\n          });\r\n        })\r\n        .catch(console.warn);\r\n    }\r\n  };\r\n\r\n  const onClickRepost = ()=>{\r\n\r\n    const model = new RepostViewModel({\r\n      postID: post.postID, \r\n      userID: authenticationService.currentUserValue.id \r\n     });\r\n\r\n    if( post.isReposted){\r\n      deleteRepost(model)\r\n      .then(handleResponse)\r\n      .then ( res =>{\r\n        const { data } = res;\r\n        setPost( data );\r\n        setState( x=>{\r\n          let copy = {...x};\r\n          copy.content         = data.content;\r\n          copy.originalContent = data.content;\r\n          copy.medias          = data.medias;\r\n          copy.originalMedias  = data.medias;\r\n          return copy;\r\n        });\r\n      })\r\n      .catch(console.warn);\r\n    }\r\n    else{\r\n      createRepost(model)\r\n      .then(handleResponse)\r\n      .then ( res =>{\r\n        const { data } = res;\r\n        setPost( data );\r\n        setState( x=>{\r\n          let copy = {...x};\r\n          copy.content         = data.content;\r\n          copy.originalContent = data.content;\r\n          copy.medias          = data.medias;\r\n          copy.originalMedias  = data.medias;\r\n          return copy;\r\n        });\r\n      })\r\n      .catch(console.warn);\r\n    }\r\n  };\r\n\r\n  const onToggleEditMode = ()=>{\r\n    setState( x =>{\r\n      let copy = {...x};\r\n      copy.editMode = !copy.editMode;\r\n\r\n      if( copy.editMode === false ){\r\n        copy.medias     = [...copy.originalMedias];\r\n        copy.content    = copy.originalContent;\r\n        copy.deleted    = [];\r\n        copy.newMedias  = [];\r\n      }\r\n      return copy;\r\n    })\r\n  };\r\n\r\n  const onClickDelete = ()=>{\r\n    if(window.confirm('Seguro que quiere borrar el post')){\r\n      deletePost(post.postID)\r\n      .then(handleResponse)\r\n      .then(res=>{\r\n        history.replace(routes.feed);\r\n      })\r\n      .catch(console.warn);\r\n    }\r\n  };\r\n\r\n  const dateString = new Date(Date.parse( post.date )).toLocaleString();\r\n\r\n  return (\r\n    <Card className={classes.root}>\r\n      {\r\n        post.isRepost &&\r\n        <Typography variant='body2' className={classes.repostText}>\r\n          <Link to={routes.getProfile(post.publisherID)} className={classes.repostUserLink}>{post.reposterUserName}</Link> reposted this!\r\n        </Typography>\r\n      }\r\n      <CardContent>\r\n          <div className={classes.displayTitle}>\r\n            <Link to={routes.getProfile(post.publisherID)}>\r\n              <Avatar src={post.publisherProfilePic} className={classes.avatar}/>\r\n            </Link>\r\n            <Link to={routes.getProfile(post.publisherID)}>\r\n              <Typography variant='h6' component='h2' className={classes.title}>\r\n                <strong>{post.publisherUserName} {'@'+post.publisherTag}</strong>\r\n              </Typography>\r\n            </Link>\r\n          </div>\r\n          <p className={classes.date}>{ dateString.slice( 0, dateString.length - 6 ) } { dateString.slice(dateString.length-3) }</p>\r\n          \r\n          {\r\n            state.editMode ? \r\n            (<textarea className={classes.contentEdit} value={state.content} onChange={onChangeContent}></textarea>)\r\n            :\r\n            (<Typography variant='body2' component='p' className={state.medias.length !== 0 ? classes.content : classes.contentNoMedia} >{state.originalContent}</Typography>)\r\n          }\r\n          \r\n          {\r\n            state.editMode &&\r\n            <>\r\n            <input accept='image/*' className={classes.input} type='file' multiple ref={inputFileRef} onChange={onChangeImages}/>\r\n              <IconButton onClick={onClickFileOpen}>\r\n                <ImageIcon className={classes.mediaIcon}/>\r\n              </IconButton>\r\n            </>\r\n          }\r\n          <div className={classes.contMedia}>\r\n            <MediaGrid media={ state.editMode ? state.medias : state.originalMedias } {...temp}/>\r\n          </div>\r\n\r\n          <div  className={classes.displaybtn}>\r\n          {\r\n            (authenticationService.currentUserValue.id === post.publisherID)\r\n            && \r\n            <>\r\n              <Button \r\n                variant='contained' \r\n                color='secondary' \r\n                onClick={onClickDelete}\r\n                className={classes.deleteBtn}\r\n              >\r\n                  Eliminar\r\n              </Button>\r\n              <Button \r\n                variant='contained' \r\n                color='secondary' \r\n                onClick={onToggleEditMode}\r\n              >\r\n                { state.editMode ? 'Cancelar' : 'Editar' }\r\n              </Button>\r\n            </>\r\n          }\r\n          </div>\r\n        </CardContent>\r\n\r\n      <CardActions disableSpacing className={classes.cardBtn}>\r\n\r\n        {\r\n          (!state.editMode)\r\n          && \r\n          <div>\r\n            <IconButton onClick={onClickLike}>\r\n              <FavoriteIcon className={ post.isLiked ? classes.likeIcon : classes.grayIcon }/>\r\n            </IconButton>\r\n            {post.likeCount}\r\n          </div>\r\n        }\r\n        \r\n        {\r\n          (!state.editMode)\r\n          && \r\n          <div>\r\n            <Link to={routes.getPost(post.postID || 1)}>\r\n              <IconButton>\r\n                <QuestionAnswerIcon className={classes.commentIcon}/>\r\n              </IconButton>\r\n            </Link>\r\n            {post.replyCount}\r\n          </div>\r\n        }\r\n        \r\n        {\r\n          (!state.editMode)\r\n          && \r\n          <div>\r\n            <IconButton onClick={onClickRepost}>\r\n              <ReplyAllIcon className={ post.isReposted ? classes.repostIcon : classes.grayIcon }/>\r\n            </IconButton>\r\n            {post.repostCount}\r\n          </div>\r\n        }\r\n\r\n        {\r\n          (authenticationService.currentUserValue.id === post.publisherID && state.editMode)\r\n          && \r\n          <div>\r\n            <IconButton onClick={onClickSave}>\r\n              <SaveIcon className={classes.saveIcon}/>\r\n            </IconButton>\r\n          </div>\r\n        }\r\n\r\n      </CardActions>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default PostCard;"]},"metadata":{},"sourceType":"module"}